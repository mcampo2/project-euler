<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyclical Figurate Numbers</title>
    <style>
        body {
            width: 30rem;
        }
    </style>
</head>
<body>
    <h1>Cyclical Figurate Numbers</h1>
    <div>
        <h2>Problem</h2>
        <p>Triangle, square, pentagonal, hexagonal, heptagonal, and octagonal
           numbers are all figurate (polygonal) numbers and are generated by the
           following formulae:</p>
        <table>
            <tbody>
                <tr>
                    <td>Triangle</td>
                    <td><i>P</i><sub>3,<i>n</i></sub> = <i>n</i>(<i>n</i> + 1)/2</td>
                    <td>1, 3, 6, 10, 15, …</td>
                </tr>
                <tr>
                    <td>Square</td>
                    <td><i>P</i><sub>4,<i>n</i></sub> = <i>n</i><sup>2</sup></td>
                    <td>1, 4, 9, 16, 25, …</td>
                </tr>
                <tr>
                    <td>Pentagonal</td>
                    <td><i>P</i><sub>5,<i>n</i></sub> = <i>n</i>(3<i>n</i> - 1)/2</td>
                    <td>1, 5, 12, 22, 35, …</td>
                </tr>
                <tr>
                    <td>Hexagonal</td>
                    <td><i>P</i><sub>6,<i>n</i></sub> = <i>n</i>(2<i>n</i> - 1)</td>
                    <td>1, 6, 15, 28, 45, …</td>
                </tr>
                <tr>
                    <td>Heptagonal</td>
                    <td><i>P</i><sub>7,<i>n</i></sub> = <i>n</i>(5<i>n</i> - 3)/2</td>
                    <td>1, 7, 18, 34, 55, …</td>
                </tr>
                <tr>
                    <td>Octagonal</td>
                    <td><i>P</i><sub>8,<i>n</i></sub> = <i>n</i>(3<i>n</i> - 2)</td>
                    <td>1, 8, 21, 40, 65, …</td>
                </tr>
            </tbody>
        </table>
        <p>The ordered set of three 4-digit numbers: 8128, 2882, 8281, has three
           interesting properties.</p>
        </p>
        <ol>
            <li>The set is cyclic, in that the last two digits of each number is
                the first two digits of the next number (including the last
                number with the first).</li>
            <li>Each polygonal type: triangle (<i>P</i><sub>3,127</sub> = 8128)
                square (<i>P</i><sub>4,91</sub> = 8281), and pentagonal
                (<i>P</i><sub>5,44</sub> = 2882), is represented by a different
                number int he set.</li>
            <li>This is the only set of 4-digit numbers with this property.</li>
        </ol>
        <p>Find the sum of the only ordered set of six cyclic 4-digit numbers
           for which each polygonal type: triangle, square, pentagonal,
           hexagonal, heptagonal, and octagonal, is represented by a different
           number in the set.</p>
    </div>
    <div>
        <h2>Solution</h2>
        <p>The sum of the only ordered set of six cyclic 4-digit numbers for
           which each polygonal type: triangle, square, pentagonal, hexagonal,
           heptagonal, and octagonal, is represented by a different number in
           the set is <b><span id="solution">???</span></b>.</p>
        <button id="solve">Solve</button>
    </div>
    <script>
        function solve() {
            answer = solveProjectEuler61();
            document.getElementById("solution").textContent = answer;
        }

        function solveProjectEuler61() {
            const min = 1000;
            const max = 9999;
            const figurates = [
                generateFigurateNumbers(3, min, max),
                generateFigurateNumbers(4, min, max),
                generateFigurateNumbers(5, min, max),
                generateFigurateNumbers(6, min, max),
                generateFigurateNumbers(7, min, max),
                generateFigurateNumbers(8, min, max),
            ];
            for (let i = 0; i < figurates.length; i++) {
                for (const num of figurates[i]) {
                    const result = findCyclicSet(figurates, [num], { [i]: true });
                    if (result) {
                        const sum = result.reduce((a, b) => a + b, 0);
                        return sum;
                    }
                }
            } return null;
        }

        function findCyclicSet(figurates, currentSet, usedTypes) {
            if (currentSet.length === 6) {
                if (isCyclic(currentSet[currentSet.length - 1], currentSet[0])) {
                    return currentSet;
                } return null;
            }
            const lastNumber = currentSet[currentSet.length - 1];
            for (let i = 0; i < figurates.length; i++) {
                if (usedTypes[i]) continue;
                for (const num of figurates[i]) {
                    if (isCyclic(lastNumber, num)) {
                        const result = findCyclicSet(figurates, [...currentSet, num], { ...usedTypes, [i]: true });
                        if (result) return result;
                    }
                }
            } return null;
        }

        function isCyclic(a, b) {
            return String(a).slice(2) === String(b).slice(0, 2);
        }

        function generateFigurateNumbers(n, min, max) {
            const numbers = [];
            let k = 1;
            while (true) {
                const num = (k * ((n - 2) * k - (n - 4))) / 2;
                if (num > max) break;
                if (num >= min) numbers.push(num);
                k++;
            } return numbers;
        }
        
        document.getElementById("solve").onclick = solve;
    </script>
</body>
</html>